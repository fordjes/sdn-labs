---
date: "2016-11-23"
draft: false
weight: 210
title: "Lab XX - Mininet Part 2"
---
[Click here to find out more about Alta3 Research's SDN Training](https://alta3.com/courses/sdn)

### TUESDAY - &#x2B50;REQUIRED&#x2B50;

### Lab Objective
The objective of this lab is to...

### Procedure

0. Close any terminals you have open. Open a new terminal, and then change to the home directory.

  `student@beachhead:/$` `cd`

0. Create a basic mininet topology

  `student@beachhead:~$` `sudo mn --topo=single,3 --controller=none --mac`

0.

  `mininet>` `dump`
  * `mininet>` `net`
  * `mininet>` `pingall`

  > Why did `pingall` fail?

0. Examine ovs-ofctl

  * `mininet>` `sh ovs-ofctl help`
  
  > Add a few questions here to make the students read the help

0. Examine ovs-dpctl

  * `mininet>` `sh ovs-dpctl help`
  
  > Add a few questions here to make the students read the help

0. Collect ovs information about ports 

  * `mininet>` `sh ovs-ofctl help`
  * `mininet>` `sh ovs-ofctl show s1`
  * `mininet>` `sh ovs-ofctl dump-flows s1`
  * `mininet>` `s1 ovs-dpctl show`

0. Add flows for L2 switch forwarding
 
  * `mininet>` `sh ovs-ofctl add-flow s1 action=normal`
  * `mininet>` `sh ovs-ofctl dump-flows s1`

0. Test pingall again 
  
  * `mininet>` `pingall`

0. Undo the flows we just created 
  
  * `mininet>` `sh ovs-ofctl del-flows s1`
  * `mininet>` `sh ovs-ofctl dump-flows s1`
  * `mininet>` `pingall`

0. Add some more specific flow entries:

  * `mininet>` `sh ovs-ofctl add-flow s1 cookie=5,in_port=1,actions=output:3`
  * `mininet>` `sh ovs-ofctl add-flow s1 cookie=5,in_port=3,actions=output:1`
  * `mininet>` `sh ovs-ofctl dump-flows s1`
  * `mininet>` `pingall`

0. Add a drop rule with priority

  * `mininet>` `sh ovs-ofctl add-flow s1 priority=200,actions=drop`
  * `mininet>` `sh ovs-ofctl dump-flows s1`
  * `mininet>` `pingall`
 
  > Did the drop prevent the traffic? Why or why not?

0. Replace the flows with priorities 

  * `mininet>` `sh ovs-ofctl del-flows s1 cookie=5/-1` [read docs about cookie=value/mask](http://openvswitch.org/support/dist-docs/ovs-ofctl.8.txt)
  * `mininet>` `sh ovs-ofctl add-flow s1 cookie=5,priority=199,in_port=1,actions=output:3`
  * `mininet>` `sh ovs-ofctl add-flow s1 cookie=5,priority=199,in_port=3,actions=output:1`
  * `mininet>` `sh ovs-ofctl dump-flows s1`
  * `mininet>` `pingall`

0. Remove the dropall flow

  * `mininet>` `sh ovs-ofctl del-flows s1 cookie=6/-1`
  * `mininet>` `sh ovs-ofctl dump-flows s1`
  * `mininet>` `pingall`

0. Add a flow based on mac addresses

  * `mininet>` `sh ovs-ofctl add-flow s1 cookie=7,priority=199,dl_src=00:00:00:00:00:01,dl_dst=00:00:00:00:00:02,actions=output:2`
  * `mininet>` `sh ovs-ofctl add-flow s1 cookie=7,priority=199,dl_src=00:00:00:00:00:02,dl_dst=00:00:00:00:00:01,actions=output:1 `
  * `mininet>` `pingall`
 
  > What's missing?

0. Add a final flow to the switch

  * `mininet>` `sh ovs-ofctl add-flow s1 dl_type=0x0806,nw_proto=1,actions=flood`
  * `mininet>` `sh ovs-ofctl dump-flows s1`
  * `mininet>` `pingall`

  > - What is dl_tyle=0x0806? 
  >
  > - What is nw_proto=1
  >
  > - Useful Links: [Link1](http://openvswitch.org/support/dist-docs/ovs-ofctl.8.txt) [Link2](https://en.wikipedia.org/wiki/EtherType) [Link3](https://en.wikipedia.org/wiki/Address_Resolution_Protocol)
  >
  > Given nw_proto=1 was allowed how did the reply (nw_proto=2) get back to the requester?

0. Cleanup  
  
  * `mininet>` `exit`
  * `student@beachhead:~$` `sudo mn --clean`
